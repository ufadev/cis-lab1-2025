# Инструкция для преподавателя

## Структура лабораторной работы

Лабораторная работа находится в директории `lab2/` и содержит:

1. **Frontend проект** (`frontend/`) - React TypeScript приложение с Vite
   - Содержит сломанный тест в `src/App.test.tsx`
   - Исправленная версия в `src/App.test.fixed.tsx`

2. **Backend проект** (`backend/`) - .NET 8 Web API
   - Содержит сломанный тест в `Tests/WeatherForecastControllerTests.cs`
   - Исправленная версия в `Tests/WeatherForecastControllerTests.fixed.cs`

3. **GitHub Actions пайплайн** (`.github/workflows/ci.yml`)
   - Запускает тесты для обоих проектов
   - Генерирует Allure отчет
   - Публикует отчет в GitHub Pages

4. **Документация**:
   - `README.md` - основная инструкция для студентов
   - `QUICKSTART.md` - быстрый старт
   - `TESTING.md` - инструкция по тестированию с act
   - `SOLUTION.md` - решение лабораторной работы

## Цели лабораторной работы

1. Познакомиться с GitHub Actions
2. Научиться тестировать пайплайны локально с помощью act
3. Настроить генерацию Allure отчетов
4. Научиться исправлять сломанные тесты
5. Понять принципы накопительных отчетов

## Проверка перед выдачей студентам

1. ✅ Убедитесь, что все зависимости указаны в `package.json` и `.csproj`
2. ✅ Проверьте, что сломанные тесты действительно падают
3. ✅ Убедитесь, что исправленные тесты проходят
4. ✅ Проверьте синтаксис YAML файлов пайплайна

## Запуск тестирования

### Локальное тестирование тестов

```bash
# Frontend (должен упасть один тест)
cd frontend
npm install
npm test

# Backend (должен упасть один тест)
cd backend
dotnet restore
dotnet test
```

### Тестирование пайплайна с act

```bash
# Установите act
brew install act  # macOS

# Загрузите образы
docker pull catthehacker/ubuntu:full-latest
docker pull node:20
docker pull mcr.microsoft.com/dotnet/sdk:8.0

# Запустите пайплайн
cd lab2
act push
```

## Ожидаемое поведение

### Первый запуск (со сломанными тестами)

1. Frontend тесты запускаются, один падает
2. Backend тесты запускаются, один падает
3. Allure отчет генерируется с информацией об упавших тестах
4. Пайплайн завершается с ошибкой (continue-on-error: true позволяет продолжить)

### После исправления тестов

1. Все тесты проходят успешно
2. Allure отчет показывает все тесты зелеными
3. Пайплайн завершается успешно
4. Отчет готов к публикации в GitHub Pages

## Проверка решения студентов

Студенты должны:

1. ✅ Запустить пайплайн через act
2. ✅ Найти сломанные тесты в Allure отчете
3. ✅ Исправить тесты
4. ✅ Повторно запустить пайплайн
5. ✅ Убедиться, что все тесты проходят

## Дополнительные задания

Для продвинутых студентов можно предложить:

1. Добавить этап линтинга кода
2. Настроить проверку покрытия кода тестами
3. Добавить матричное тестирование (разные версии Node.js/.NET)
4. Настроить уведомления при падении тестов
5. Добавить этап сборки приложений

## Решение проблем

### Проблема: act не работает

**Решение**: Убедитесь, что Docker запущен и образы загружены

### Проблема: Тесты не генерируют Allure отчеты

**Решение**: 
- Проверьте установку пакетов `allure-vitest` и `allure.xunit`
- Убедитесь, что конфигурация правильная

### Проблема: GitHub Pages не публикует отчет

**Решение**:
- Проверьте настройки репозитория
- Убедитесь, что пайплайн запускается на main/master ветке
- Проверьте права доступа GITHUB_TOKEN

## Оценка

Критерии оценки:

- **Отлично (5)**: Все задачи выполнены, пайплайн работает, отчет публикуется
- **Хорошо (4)**: Основные задачи выполнены, есть мелкие недочеты
- **Удовлетворительно (3)**: Пайплайн работает, но есть проблемы с отчетами
- **Неудовлетворительно (2)**: Пайплайн не работает или задачи не выполнены

## Дополнительные материалы

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Allure Framework](https://docs.qameta.io/allure/)
- [act - Run GitHub Actions locally](https://github.com/nektos/act)
- [Vitest Documentation](https://vitest.dev/)
- [xUnit Documentation](https://xunit.net/)

